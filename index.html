<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>DolbaebSMS - Market Update</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Inter', 'sans-serif'] },
            animation: {
              'fade-in': 'fadeIn 0.3s ease-out',
              'slide-up': 'slideUp 0.3s ease-out',
              'pulse-gold': 'pulseGold 2s infinite',
              'float': 'float 3s ease-in-out infinite',
            },
            keyframes: {
              fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
              slideUp: { '0%': { transform: 'translateY(10px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
              pulseGold: { '0%, 100%': { transform: 'scale(1)', opacity: '1' }, '50%': { transform: 'scale(1.05)', opacity: '0.8' } },
              float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } }
            }
          }
        }
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      * { box-sizing: border-box; }
      body { background-color: #0f172a; color: #e2e8f0; height: 100vh; overflow: hidden; }
      #root { height: 100vh; overflow: hidden; }
      ::-webkit-scrollbar { width: 5px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
      
      .nft-container { position: relative; display: inline-block; }
      .nft-orbital { position: absolute; width: 60px; height: 60px; top: 50%; left: 50%; margin-top: -30px; margin-left: -30px; animation: orbit 10s linear infinite; pointer-events: none; z-index: 10; }
      .nft-item { position: absolute; font-size: 16px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; animation: float 3s ease-in-out infinite; text-shadow: 0 0 5px black; }
      @keyframes orbit { 0% { transform: rotate(0deg) translateX(35px) rotate(0deg); } 100% { transform: rotate(360deg) translateX(35px) rotate(-360deg); } }
      
      .rarity-common { border: 1px solid #9ca3af; background: rgba(156, 163, 175, 0.1); }
      .rarity-rare { border: 1px solid #3b82f6; background: rgba(59, 130, 246, 0.1); }
      .rarity-epic { border: 1px solid #a855f7; background: rgba(168, 85, 247, 0.1); }
      .rarity-legendary { border: 1px solid #eab308; background: rgba(234, 179, 8, 0.1); box-shadow: 0 0 10px rgba(234, 179, 8, 0.2); }
      .rarity-mythic { border: 1px solid #ef4444; background: rgba(239, 68, 68, 0.1); box-shadow: 0 0 15px rgba(239, 68, 68, 0.3); animation: pulse-red 2s infinite; }

      .float-fn { color: #4ade80; } /* Factory New */
      .float-mw { color: #a3e635; } /* Minimal Wear */
      .float-ft { color: #facc15; } /* Field Tested */
      .float-ww { color: #fb923c; } /* Well Worn */
      .float-bs { color: #f87171; } /* Battle Scarred */

      @media (max-width: 640px) {
        .mobile-chat-hidden { display: none; }
        .mobile-chat-visible { display: flex; width: 100%; }
        .mobile-sidebar-hidden { display: none; }
      }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.263.1?deps=react@18.2.0",
        "date-fns": "https://esm.sh/date-fns@2.30.0",
        "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
        "firebase/database": "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { Search, Send, Image as ImageIcon, Mic, X, ChevronLeft, Settings, Trash2, Smile, MoreVertical, LogOut, User, Loader2, Coins, TrendingUp, Info, ShoppingCart } from 'lucide-react';
        import { format } from 'date-fns';
        import { initializeApp } from 'firebase/app';
        import { getDatabase, ref, onValue, set, update, push, off, query, orderByChild, startAt, endAt, remove, get } from 'firebase/database';

        const firebaseConfig = {
          apiKey: "AIzaSyA35T6z2FYS6m9IEJ9x7evxCphgpLhgMX4",
          authDomain: "dolbaebsms-live.firebaseapp.com",
          databaseURL: "https://dolbaebsms-live-default-rtdb.firebaseio.com",
          projectId: "dolbaebsms-live",
          storageBucket: "dolbaebsms-live.firebasestorage.app",
          messagingSenderId: "912825721862",
          appId: "1:912825721862:web:b92d7f7f553ca4536c0f87",
          measurementId: "G-SCD5JVFM5E"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // --- NFT DEFINITIONS ---
        const NFT_ITEMS = [
            // Common (Start ~500)
            { id: 'apple', emoji: 'üçé', name: '–Ø–±–ª–æ–∫–æ', base: 500, rarity: 'common' },
            { id: 'rock', emoji: 'ü™®', name: '–ö–∞–º–µ–Ω—å', base: 450, rarity: 'common' },
            { id: 'wood', emoji: 'ü™µ', name: '–ë—Ä–µ–≤–Ω–æ', base: 480, rarity: 'common' },
            { id: 'leaf', emoji: 'üçÉ', name: '–õ–∏—Å—Ç', base: 420, rarity: 'common' },
            { id: 'bread', emoji: 'üçû', name: '–•–ª–µ–±', base: 550, rarity: 'common' },
            { id: 'mouse', emoji: 'üê≠', name: '–ú—ã—à—å', base: 600, rarity: 'common' },
            { id: 'ant', emoji: 'üêú', name: '–ú—É—Ä–∞–≤–µ–π', base: 400, rarity: 'common' },
            
            // Rare (Start ~1000-1500)
            { id: 'sword', emoji: '‚öîÔ∏è', name: '–ú–µ—á', base: 1200, rarity: 'rare' },
            { id: 'shield', emoji: 'üõ°Ô∏è', name: '–©–∏—Ç', base: 1100, rarity: 'rare' },
            { id: 'potion', emoji: 'üß™', name: '–ó–µ–ª—å–µ', base: 1300, rarity: 'rare' },
            { id: 'bow', emoji: 'üèπ', name: '–õ—É–∫', base: 1250, rarity: 'rare' },
            { id: 'ring', emoji: 'üíç', name: '–ö–æ–ª—å—Ü–æ', base: 1500, rarity: 'rare' },
            { id: 'ghost', emoji: 'üëª', name: '–ü—Ä–∏–∑—Ä–∞–∫', base: 1400, rarity: 'rare' },
            { id: 'alien', emoji: 'üëΩ', name: '–ü—Ä–∏—à–µ–ª–µ—Ü', base: 1450, rarity: 'rare' },
            { id: 'robot', emoji: 'ü§ñ', name: '–†–æ–±–æ—Ç', base: 1350, rarity: 'rare' },
            
            // Epic (Start ~2500-4000)
            { id: 'car', emoji: 'üèéÔ∏è', name: '–°–ø–æ—Ä—Ç–∫–∞—Ä', base: 2800, rarity: 'epic' },
            { id: 'house', emoji: 'üè†', name: '–î–æ–º', base: 3500, rarity: 'epic' },
            { id: 'island', emoji: 'üèùÔ∏è', name: '–û—Å—Ç—Ä–æ–≤', base: 4000, rarity: 'epic' },
            { id: 'tiger', emoji: 'üêØ', name: '–¢–∏–≥—Ä', base: 2600, rarity: 'epic' },
            { id: 'dragon_egg', emoji: 'ü•ö', name: '–Ø–π—Ü–æ –î—Ä–∞–∫–æ–Ω–∞', base: 3200, rarity: 'epic' },
            { id: 'diamond', emoji: 'üíé', name: '–ê–ª–º–∞–∑', base: 3000, rarity: 'epic' },
            
            // Legendary (Start ~8000-12000)
            { id: 'dragon', emoji: 'üêâ', name: '–î—Ä–∞–∫–æ–Ω', base: 9000, rarity: 'legendary' },
            { id: 'unicorn', emoji: 'ü¶Ñ', name: '–ï–¥–∏–Ω–æ—Ä–æ–≥', base: 8500, rarity: 'legendary' },
            { id: 'rocket', emoji: 'üöÄ', name: '–†–∞–∫–µ—Ç–∞', base: 10000, rarity: 'legendary' },
            { id: 'crown', emoji: 'üëë', name: '–ö–æ—Ä–æ–Ω–∞', base: 12000, rarity: 'legendary' },
            { id: 'earth', emoji: 'üåç', name: '–ó–µ–º–ª—è', base: 15000, rarity: 'legendary' },
            
            // Mythic (Start ~50000+)
            { id: 'blackhole', emoji: 'üï≥Ô∏è', name: '–ß–µ—Ä–Ω–∞—è –î—ã—Ä–∞', base: 50000, rarity: 'mythic' },
            { id: 'galaxy', emoji: 'üåå', name: '–ì–∞–ª–∞–∫—Ç–∏–∫–∞', base: 60000, rarity: 'mythic' },
            { id: 'time', emoji: '‚è≥', name: '–í—Ä–µ–º—è', base: 75000, rarity: 'mythic' }
        ];

        // --- COMPONENTS ---

        const Button = ({ children, variant = 'primary', className = '', ...props }) => {
            const variants = {
                primary: "bg-indigo-600 hover:bg-indigo-500 text-white",
                secondary: "bg-slate-700 hover:bg-slate-600 text-slate-100",
                danger: "bg-red-500/20 text-red-500 border border-red-500/50",
                gold: "bg-yellow-600 hover:bg-yellow-500 text-white shadow-lg shadow-yellow-500/20"
            };
            return (
                <button className={`px-4 py-2 rounded-xl font-medium transition active:scale-95 disabled:opacity-50 flex items-center justify-center gap-2 ${variants[variant]} ${className}`} {...props}>
                    {children}
                </button>
            );
        };

        const NFTMarket = ({ isOpen, onClose, currentUser, userCoins, userNFTs }) => {
            const [marketPrices, setMarketPrices] = useState({});
            const [activeTab, setActiveTab] = useState('buy'); // buy, sell
            const [isLoading, setIsLoading] = useState(false);

            // Logic to fetch/update market prices
            useEffect(() => {
                if (!isOpen) return;
                
                const marketRef = ref(db, 'market_v2');
                const unsub = onValue(marketRef, (snap) => {
                    const data = snap.val() || { prices: {}, lastUpdate: 0 };
                    const now = Date.now();

                    // If data is old (> 20 sec), update it (Client-side simulation of server logic)
                    if (now - data.lastUpdate > 20000) {
                        const newPrices = {};
                        NFT_ITEMS.forEach(item => {
                            const oldPrice = data.prices[item.id] || item.base;
                            // Volatility: +/- 10%
                            const change = (Math.random() - 0.5) * 0.2; 
                            let newPrice = Math.floor(oldPrice * (1 + change));
                            // Clamp price (min 10% of base, max 500% of base)
                            newPrice = Math.max(Math.floor(item.base * 0.1), Math.min(Math.floor(item.base * 5), newPrice));
                            newPrices[item.id] = newPrice;
                        });
                        update(marketRef, { prices: newPrices, lastUpdate: now });
                    } else {
                        setMarketPrices(data.prices);
                    }
                });
                return () => off(marketRef);
            }, [isOpen]);

            if (!isOpen) return null;

            const buyNFT = async (item) => {
                const price = marketPrices[item.id] || item.base;
                if (userCoins < price) { alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤"); return; }
                
                setIsLoading(true);
                // Create unique Item
                const newItem = {
                    id: item.id,
                    uuid: Date.now() + Math.random().toString(),
                    float: parseFloat(Math.random().toFixed(4)), // 0.0000 - 1.0000
                    pattern: Math.floor(Math.random() * 1000),
                    boughtAt: price,
                    isEquipped: false
                };

                try {
                    const newNFTList = [...(userNFTs || []), newItem];
                    await update(ref(db, `users/${currentUser}`), {
                        coins: userCoins - price,
                        nfts: newNFTList
                    });
                    alert(`–ö—É–ø–ª–µ–Ω–æ! Float: ${newItem.float}`);
                } catch(e) { console.error(e); }
                setIsLoading(false);
            };

            const sellNFT = async (userItem) => {
                const baseMarketPrice = marketPrices[userItem.id] || 0;
                // Price formula: MarketPrice * (1 - 0.5 * float) 
                // Best float (0.00) = 100% price, Worst (1.00) = 50% price
                const sellPrice = Math.floor(baseMarketPrice * (1 - (userItem.float * 0.5)));

                if(confirm(`–ü—Ä–æ–¥–∞—Ç—å –∑–∞ ${sellPrice}? (–ò–∑–Ω–æ—Å —Å–Ω–∏–∑–∏–ª —Ü–µ–Ω—É –Ω–∞ ${Math.floor(userItem.float * 50)}%)`)) {
                    setIsLoading(true);
                    const newNFTList = userNFTs.filter(n => n.uuid !== userItem.uuid);
                    await update(ref(db, `users/${currentUser}`), {
                        coins: userCoins + sellPrice,
                        nfts: newNFTList
                    });
                    setIsLoading(false);
                }
            };

            const toggleEquip = async (userItem) => {
                const newNFTList = userNFTs.map(n => {
                    if (n.uuid === userItem.uuid) return { ...n, isEquipped: !n.isEquipped };
                    return n;
                });
                await update(ref(db, `users/${currentUser}`), { nfts: newNFTList });
            };

            const getFloatColor = (f) => {
                if(f < 0.07) return 'text-green-400 font-bold'; // FN
                if(f < 0.15) return 'text-green-200'; // MW
                if(f < 0.38) return 'text-yellow-200'; // FT
                if(f < 0.45) return 'text-orange-300'; // WW
                return 'text-red-400'; // BS
            };

            const getRarityClass = (r) => `rarity-${r}`;

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                    <div className="w-full max-w-4xl bg-slate-900 border border-slate-700 rounded-2xl flex flex-col max-h-[90vh]">
                        <div className="p-4 border-b border-slate-800 flex justify-between items-center">
                            <h2 className="text-xl font-bold text-white flex gap-2"><ShoppingCart className="text-yellow-500"/> –ë–∏—Ä–∂–∞ NFT</h2>
                            <button onClick={onClose}><X className="text-slate-400"/></button>
                        </div>
                        <div className="flex bg-slate-800/50">
                            <button onClick={() => setActiveTab('buy')} className={`flex-1 p-3 ${activeTab === 'buy' ? 'text-white border-b-2 border-indigo-500' : 'text-slate-400'}`}>–ö—É–ø–∏—Ç—å</button>
                            <button onClick={() => setActiveTab('sell')} className={`flex-1 p-3 ${activeTab === 'sell' ? 'text-white border-b-2 border-indigo-500' : 'text-slate-400'}`}>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å / –ü—Ä–æ–¥–∞—Ç—å</button>
                        </div>
                        <div className="flex-1 overflow-y-auto p-4 custom-scrollbar bg-slate-950">
                            {activeTab === 'buy' ? (
                                <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
                                    {NFT_ITEMS.map(item => {
                                        const price = marketPrices[item.id] || item.base;
                                        const diff = price - item.base;
                                        return (
                                            <div key={item.id} className={`p-3 rounded-xl flex flex-col items-center gap-2 ${getRarityClass(item.rarity)}`}>
                                                <div className="text-4xl">{item.emoji}</div>
                                                <div className="text-center">
                                                    <div className="font-bold text-sm">{item.name}</div>
                                                    <div className={`text-xs ${diff >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                                        {price} ({diff > 0 ? '+' : ''}{Math.floor((diff/item.base)*100)}%)
                                                    </div>
                                                </div>
                                                <Button disabled={isLoading} onClick={() => buyNFT(item)} variant="gold" className="w-full text-xs h-8">–ö—É–ø–∏—Ç—å</Button>
                                            </div>
                                        )
                                    })}
                                </div>
                            ) : (
                                <div className="grid grid-cols-2 sm:grid-cols-3 gap-3">
                                    {userNFTs && userNFTs.length > 0 ? userNFTs.map(inst => {
                                        const def = NFT_ITEMS.find(n => n.id === inst.id);
                                        if(!def) return null;
                                        const marketP = marketPrices[def.id] || def.base;
                                        const value = Math.floor(marketP * (1 - (inst.float * 0.5)));
                                        return (
                                            <div key={inst.uuid} className={`p-3 rounded-xl flex flex-col items-center gap-1 border ${inst.isEquipped ? 'border-green-500 bg-green-500/10' : 'border-slate-700 bg-slate-900'}`}>
                                                <div className="text-4xl">{def.emoji}</div>
                                                <div className="font-bold text-sm">{def.name}</div>
                                                <div className={`text-[10px] ${getFloatColor(inst.float)}`}>Float: {inst.float}</div>
                                                <div className="text-[10px] text-slate-500">Pattern: {inst.pattern}</div>
                                                <div className="text-xs text-yellow-500 font-mono">~{value} coins</div>
                                                <div className="flex gap-1 w-full mt-2">
                                                    <Button onClick={() => toggleEquip(inst)} variant="secondary" className="flex-1 text-[10px] h-7 px-0">{inst.isEquipped ? '–°–Ω—è—Ç—å' : '–ù–∞–¥–µ—Ç—å'}</Button>
                                                    <Button onClick={() => sellNFT(inst)} variant="danger" className="flex-1 text-[10px] h-7 px-0">Sell</Button>
                                                </div>
                                            </div>
                                        )
                                    }) : <div className="text-slate-500 text-center col-span-full">–ü—É—Å—Ç–æ</div>}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const ChatBubble = ({ msg, isMe, usersData }) => {
            const date = new Date(msg.timestamp);
            return (
                <div className={`flex mb-4 ${isMe ? 'justify-end' : 'justify-start'} animate-slide-up`}>
                    {!isMe && (
                        <div className="nft-container mr-2 shrink-0">
                            <div className="w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center text-sm border border-slate-600">
                                {usersData[msg.sender]?.avatar || msg.sender[0].toUpperCase()}
                            </div>
                            {usersData[msg.sender]?.nfts && (
                                <div className="nft-orbital">
                                    {usersData[msg.sender].nfts.filter(n=>n.isEquipped).map((n, i, arr) => {
                                        const def = NFT_ITEMS.find(d => d.id === n.id);
                                        if(!def) return null;
                                        const angle = (i / arr.length) * 360;
                                        return <div key={n.uuid} className="nft-item" style={{transform: `rotate(${angle}deg) translateX(25px) rotate(-${angle}deg)`}}>{def.emoji}</div>
                                    })}
                                </div>
                            )}
                        </div>
                    )}
                    <div className={`max-w-[75%] rounded-2xl px-4 py-2 ${isMe ? 'bg-indigo-600 text-white rounded-br-none' : 'bg-slate-800 text-slate-200 rounded-bl-none'}`}>
                        {!isMe && <div className="text-[10px] text-slate-400 mb-1">{msg.sender}</div>}
                        {msg.type === 'photo' ? (
                            <img src={msg.content} className="rounded-lg max-w-full" alt="img" />
                        ) : msg.type === 'audio' ? (
                            <audio controls src={msg.content} className="w-[200px] h-8" />
                        ) : (
                            <p className="whitespace-pre-wrap break-words">{msg.content}</p>
                        )}
                        <div className="text-[9px] opacity-70 text-right mt-1">{format(date, 'HH:mm')}</div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [user, setUser] = useState(() => localStorage.getItem('user'));
            const [loginInput, setLoginInput] = useState('');
            const [usersData, setUsersData] = useState({});
            const [chats, setChats] = useState([]);
            const [activeChat, setActiveChat] = useState(null);
            const [messages, setMessages] = useState([]);
            const [inputText, setInputText] = useState('');
            const [searchQuery, setSearchQuery] = useState('');
            
            // Modals
            const [isNFTMarketOpen, setNFTMarketOpen] = useState(false);
            const [isSettingsOpen, setSettingsOpen] = useState(false);

            // User Self Data
            const [coins, setCoins] = useState(0);
            const [myNFTs, setMyNFTs] = useState([]);

            // Init App
            useEffect(() => {
                if (user) {
                    // Load User Data
                    const userRef = ref(db, `users/${user}`);
                    onValue(userRef, snap => {
                        const d = snap.val();
                        if (d) {
                            setCoins(d.coins || 0);
                            setMyNFTs(d.nfts || []);
                        }
                    });

                    // Load All Users (for avatars/nfts display)
                    onValue(ref(db, 'users'), snap => setUsersData(snap.val() || {}));

                    // Load Chats
                    const msgRef = ref(db, 'messages');
                    onValue(msgRef, snap => {
                        const allMsgs = snap.val() || {};
                        const chatSet = new Set();
                        
                        Object.keys(allMsgs).forEach(key => {
                            const participants = key.split('_');
                            if (participants.includes(user)) {
                                const other = participants.find(p => p !== user);
                                chatSet.add(other);
                            }
                        });
                        setChats(Array.from(chatSet));
                    });
                }
            }, [user]);

            // Load Active Chat Messages
            useEffect(() => {
                if (user && activeChat) {
                    const chatId = [user, activeChat].sort().join('_');
                    const chatRef = ref(db, `messages/${chatId}`);
                    const unsub = onValue(chatRef, snap => {
                        const msgs = snap.val();
                        if (msgs) {
                            setMessages(Object.values(msgs).sort((a,b) => a.timestamp - b.timestamp));
                        } else {
                            setMessages([]);
                        }
                    });
                    return () => off(chatRef);
                }
            }, [user, activeChat]);

            const handleLogin = () => {
                const nick = loginInput.trim().toLowerCase().replace(/[^a-z0-9–∞-—è]/g, '').substring(0, 20);
                if (!nick) return alert('–ù–∏–∫–Ω–µ–π–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω');
                
                // Create user if not exists
                const uRef = ref(db, `users/${nick}`);
                get(uRef).then(snap => {
                    if (!snap.exists()) {
                        set(uRef, { coins: 1000, joined: Date.now() }); // Bonus start coins
                    }
                });
                
                localStorage.setItem('user', nick);
                setUser(nick);
            };

            const sendMessage = (type = 'text', content = inputText) => {
                if (!content && type === 'text') return;
                const chatId = [user, activeChat].sort().join('_');
                push(ref(db, `messages/${chatId}`), {
                    sender: user,
                    type,
                    content,
                    timestamp: Date.now()
                });
                setInputText('');
            };

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (ev) => sendMessage('photo', ev.target.result);
                reader.readAsDataURL(file);
            };

            if (!user) {
                return (
                    <div className="flex h-screen items-center justify-center bg-slate-950">
                        <div className="bg-slate-900 p-8 rounded-2xl border border-slate-700 shadow-2xl w-full max-w-sm">
                            <h1 className="text-3xl font-bold text-center mb-2 text-white">DolbaebSMS</h1>
                            <p className="text-center text-slate-400 mb-6 text-sm">Economy & Chats</p>
                            <input 
                                className="w-full bg-slate-800 border border-slate-600 rounded-xl p-3 text-white mb-4 outline-none focus:border-indigo-500"
                                placeholder="–ù–∏–∫–Ω–µ–π–º (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã/—Ü–∏—Ñ—Ä—ã)"
                                value={loginInput}
                                onChange={e => setLoginInput(e.target.value)}
                            />
                            <Button onClick={handleLogin} className="w-full">–í–æ–π—Ç–∏</Button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="flex h-screen bg-slate-950 text-slate-100 overflow-hidden">
                    <NFTMarket 
                        isOpen={isNFTMarketOpen} 
                        onClose={() => setNFTMarketOpen(false)}
                        currentUser={user}
                        userCoins={coins}
                        userNFTs={myNFTs}
                    />

                    {/* Sidebar */}
                    <div className={`w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col ${activeChat ? 'mobile-sidebar-hidden' : 'mobile-sidebar-visible'}`}>
                        {/* Header */}
                        <div className="p-4 border-b border-slate-800 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="nft-container">
                                    <div className
